var jssim=jssim||{};!function(t){t.exchange=function(t,e,i){var n=t[e];t[e]=t[i],t[i]=n},t.shuffle=function(e){for(var i=e.length,n=1;n<i;++n){var s=Math.floor(Math.random()*(1+n));t.exchange(e,n,s)}};var e=function(t){t||(t=function(t,e){return t-e}),this.s=[],this.N=0,this.compare=t};e.prototype.less=function(t,e){return this.compare(t,e)<0},e.prototype.enqueue=function(t){for(;this.s.length<=this.N+1;)this.s.push(0);this.s[++this.N]=t,this.swim(this.N)},e.prototype.delMin=function(){if(0==this.N)return null;var e=this.s[1];return t.exchange(this.s,1,this.N--),this.sink(1),e},e.prototype.min=function(){return 0==this.N?null:this.s[1]},e.prototype.sink=function(e){for(;2*e<=this.N;){var i=2*e;if(i<this.N&&this.less(this.s[i+1],this.s[i])&&i++,!this.less(this.s[i],this.s[e]))break;t.exchange(this.s,i,e),e=i}},e.prototype.swim=function(e){for(;e>1;){var i=Math.floor(e/2);if(!this.less(this.s[e],this.s[i]))break;t.exchange(this.s,e,i),e=i}},e.prototype.clear=function(){this.s=[],this.N=0},e.prototype.size=function(){return this.N},e.prototype.isEmpty=function(){return 0==this.N},t.MinPQ=e;var i=function(t){this.time=0,this.rank=t||1,this.rank<1&&(this.rank=1)},n=function(){this.pq=new t.MinPQ(function(t,e){var i=t.time-e.time;return 0==i?e.rank-t.rank:i}),this.current_time=null,this.current_rank=null};n.prototype.update=function(){for(var e=null,i=null,n=[];!this.pq.isEmpty();){var s=this.pq.min(),r=s.time,o=s.rank;if(null==e)e=r;else if(e!=r)break;if(null==i)i=o;else if(i!=o)break;n.push(this.pq.delMin())}t.shuffle(n);for(u=0;u<n.length;++u){var h=0;h=null!=this.current_time?e-this.current_time:e,n[u].update?n[u].update(h):console.log("event does not define update(deltaTime) method!!!")}n.length>0&&(this.current_time=e,this.current_rank=i);for(var u=0;u<n.length;++u)n[u].repeatInterval&&this.scheduleRepeatingAt(n[u],this.current_time+n[u].repeatInterval,n[u].repeatInterval);return n},n.prototype.schedule=function(t,e){t.time=e,this.pq.enqueue(t)},n.prototype.hasEvents=function(){return!this.pq.isEmpty()},n.prototype.scheduleOnceIn=function(t,e){var i=this.current_time;null==this.current_time&&(i=0),t.time=i+e,this.pq.enqueue(t)},n.prototype.scheduleRepeatingIn=function(t,e){var i=this.current_time;null==this.current_time&&(i=0),this.scheduleRepeatingAt(t,i+e,e)},n.prototype.scheduleRepeatingAt=function(t,e,i){t.time=e,t.repeatInterval=i,this.pq.enqueue(t)},n.prototype.reset=function(){this.current_rank=null,this.current_time=null,this.pq.clear()},t.SimEvent=i,t.Scheduler=n;var s=function(t,e){this.x=t,this.y=e};s.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},s.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.prototype.resize=function(t){var e=t/this.length();this.x*=e,this.y*=e},t.Vector2D=s;var r=function(){this.locations=[],this.agents=[]};r.prototype.reset=function(){this.locations=[],this.agents=[]},r.prototype.getLocation=function(t){return this.locations[t]},r.prototype.getAgent=function(t){return this.agents[t]},r.prototype.updateAgent=function(e,i,n){this.locations[e.id]=new t.Vector2D(i,n),this.agents[e.id]=e},r.prototype.findAllAgents=function(){return this.agents},r.prototype.render=function(t){var e=t.getContext("2d");e.clearRect(0,0,t.width,t.height);for(id in this.locations){var i=this.agents[id],n=this.locations[id];e.fillStyle="#000000",i.color&&(e.fillStyle=i.color),e.fillRect(n.x,n.y,20,20)}},t.Space2D=r}(jssim);var module=module||{};module&&(module.exports=jssim);