var jssim=jssim||{};!function(t){t.exchange=function(t,i,e){var s=t[i];t[i]=t[e],t[e]=s},t.shuffle=function(i){for(var e=i.length,s=1;s<e;++s){var n=Math.floor(Math.random()*(1+s));t.exchange(i,s,n)}};var i=function(t){t||(t=function(t,i){return t-i}),this.s=[],this.N=0,this.compare=t};i.prototype.less=function(t,i){return this.compare(t,i)<0},i.prototype.enqueue=function(t){for(;this.s.length<=this.N+1;)this.s.push(0);this.s[++this.N]=t,this.swim(this.N)},i.prototype.delMin=function(){if(0==this.N)return null;var i=this.s[1];return t.exchange(this.s,1,this.N--),this.sink(1),i},i.prototype.min=function(){return 0==this.N?null:this.s[1]},i.prototype.sink=function(i){for(;2*i<=this.N;){var e=2*i;if(e<this.N&&this.less(this.s[e+1],this.s[e])&&e++,!this.less(this.s[e],this.s[i]))break;t.exchange(this.s,e,i),i=e}},i.prototype.swim=function(i){for(;i>1;){var e=Math.floor(i/2);if(!this.less(this.s[i],this.s[e]))break;t.exchange(this.s,i,e),i=e}},i.prototype.clear=function(){this.s=[],this.N=0},i.prototype.size=function(){return this.N},i.prototype.isEmpty=function(){return 0==this.N},t.MinPQ=i;var e=function(t){this.time=0,this.rank=t||1,this.rank<1&&(this.rank=1)},s=function(){this.pq=new t.MinPQ(function(t,i){var e=t.time-i.time;return 0==e?i.rank-t.rank:e}),this.current_time=null,this.current_rank=null};s.prototype.update=function(){for(var t=null;!this.pq.isEmpty();){var i=this.pq.min(),e=i.time;i.rank;if(null==t)t=e;else if(t!=e)break;this.update_mini()}},s.prototype.update_mini=function(){for(var i=null,e=null,s=[];!this.pq.isEmpty();){var n=this.pq.min(),r=n.time,h=n.rank;if(null==i)i=r;else if(i!=r)break;if(null==e)e=h;else if(e!=h)break;s.push(this.pq.delMin())}t.shuffle(s);for(l=0;l<s.length;++l){var o=0;o=null!=this.current_time?i-this.current_time:i,s[l].update?s[l].update(o):console.log("event does not define update(deltaTime) method!!!")}s.length>0&&(this.current_time=i,this.current_rank=e);for(var l=0;l<s.length;++l)s[l].repeatInterval&&this.scheduleRepeatingAt(s[l],this.current_time+s[l].repeatInterval,s[l].repeatInterval);return s},s.prototype.schedule=function(t,i){t.time=i,this.pq.enqueue(t)},s.prototype.hasEvents=function(){return!this.pq.isEmpty()},s.prototype.scheduleOnceIn=function(t,i){var e=this.current_time;null==this.current_time&&(e=0),t.time=e+i,this.pq.enqueue(t)},s.prototype.scheduleRepeatingIn=function(t,i){var e=this.current_time;null==this.current_time&&(e=0),this.scheduleRepeatingAt(t,e+i,i)},s.prototype.scheduleRepeatingAt=function(t,i,e){t.time=i,t.repeatInterval=e,this.pq.enqueue(t)},s.prototype.reset=function(){this.current_rank=null,this.current_time=null,this.pq.clear()},t.SimEvent=e,t.Scheduler=s;var n=function(t,i){this.x=t,this.y=i};n.prototype.distance=function(t){var i=this.x-t.x,e=this.y-t.y;return Math.sqrt(i*i+e*e)},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.resize=function(t){var i=this.length();if(0!=i){var e=t/i;this.x*=e,this.y*=e}},n.prototype.addIn=function(t){this.x+=t.x,this.y+=t.y},n.prototype.set=function(t,i){this.x=t,this.y=i},t.Vector2D=n;var r=function(t,i,e,s){this.x1=t,this.y1=i,this.x2=e,this.y2=s};t.Line2D=r;var h=function(){this.locations=[],this.agents=[],this.width=100,this.height=100,this.lines=[],this.cellWidth=1,this.cellHeight=1};h.prototype.reset=function(){this.locations=[],this.agents=[],this.lines=[]},h.prototype.getLocation=function(t){return this.locations[t]},h.prototype.getAgent=function(t){return this.agents[t]},h.prototype.updateAgent=function(i,e,s){this.locations[i.id]=new t.Vector2D(e,s),this.agents[i.id]=i},h.prototype.findAllAgents=function(){return this.agents},h.prototype.drawLine=function(i,e,s,n){this.lines.push(new t.Line2D(i,e,s,n))},h.prototype.clearLines=function(){this.lines=[]},h.prototype.render=function(t){if(t){var i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.strokeStyle="#0000FF";for(var e=0,s=0,n=0;n<this.lines.length;++n){i.beginPath();var r=this.lines[n],h=r.x1,o=r.y1,l=r.x2,u=r.y2;console.log(h+", "+o+" == "+e+s),e=l,s=u,i.moveTo(h*this.cellWidth,t.height-o*this.cellHeight),i.lineTo(l*this.cellWidth,t.height-u*this.cellHeight),i.stroke()}for(id in this.locations){var a=this.agents[id],c=this.locations[id];i.fillStyle="#000000",a.color&&(i.fillStyle=a.color);var p=20,f=20;a.size&&(p=a.size.x,f=a.size.y),p||(p=20),f||(f=20),a.id&&(i.font="12 Arial",i.fillText(""+a.id,c.x,t.height-c.y)),i.fillRect(c.x,t.height-c.y,p,f)}}},t.Space2D=h;var o=function(t){this.value=t,this.next=null};t.StackNode=o;var l=function(){this.N=0,this.first=null};l.prototype.push=function(i){var e=this.first;this.first=new t.StackNode(i),this.first.next=e,this.N++},l.prototype.pop=function(t){var i=this.first;if(null==i)return null;var t=i.value;return this.first=i.next,this.N--,t},l.prototype.clear=function(){this.N=0,this.first=null},l.prototype.size=function(){return this.N},l.prototype.isEmpty=function(){return 0==this.N},t.Stack=l;var u=function(t){this.value=t,this.next=null};t.QueueNode=u;var a=function(){this.first=null,this.last=null,this.N=0};a.prototype.enqueue=function(i){var e=this.last;this.last=new t.QueueNode(i),null!=e&&(e.next=this.last),null==this.first&&(this.first=this.last),this.N++},a.prototype.dequeue=function(){var t=this.first;if(null==t)return null;var i=t.value;return this.first=t.next,null==this.first&&(this.last=null),this.N--,i},a.prototype.clear=function(){this.first=null,this.last=null,this.N=0},a.prototype.isEmpty=function(){return 0==this.N},a.prototype.size=function(){return this.N},t.Queue=a;var c=function(t,i){this.width=t,this.height=i,this.cells=[],this.trails=[];for(var e=0;e<t;++e){this.cells.push([]),this.trails.push([]);for(var s=0;s<i;++s)this.cells[e].push(0),this.trails[e].push(0)}this.color="#ff0000",this.trailColor="#55aa55",this.cellWidth=10,this.cellHeight=10,this.showTrails=!1};c.prototype.setCell=function(t,i,e){this.cells[t][i]=e,e>0&&(this.trails[t][i]=1)},c.prototype.getCell=function(t,i){return this.cells[t][i]},c.prototype.makeCopy=function(){for(var t=new c(this.width,this.height),i=0;i<this.width;++i)for(var e=0;e<this.height;++e)0!=this.cells[i][e]&&t.setCell(i,e,1);return t},c.prototype.reset=function(){for(var t=0;t<this.width;++t)for(var i=0;i<this.height;++i)this.cells[t][i]=0,this.trails[t][i]=0},c.prototype.render=function(t){if(t){var i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.fillStyle=this.color;for(var e=0;e<this.width;++e)for(var s=0;s<this.height;++s)1==this.cells[e][s]?(i.fillStyle=this.color,i.fillRect(e*this.cellWidth,s*this.cellHeight,this.cellWidth-1,this.cellHeight-1)):this.showTrails&&1==this.trails[e][s]&&(i.fillStyle=this.trailColor,i.fillRect(e*this.cellWidth,s*this.cellHeight,this.cellWidth-1,this.cellHeight-1))}},t.Grid=c;var p=function(t,i,e){this.v=t,this.w=i,this.info=e};p.prototype.other=function(t){return t==this.v?this.w:this.v},p.prototype.either=function(){return this.v},t.Edge=p;var f=function(t){this.V=t,this.adjList=[];for(var i=0;i<t;++i)this.adjList.push([])};f.prototype.adj=function(t){return this.adjList[t]},f.prototype.reset=function(){this.adjList=[];for(var t=0;t<this.V;++t)this.adjList.push([])},f.prototype.addEdge=function(t){var i=t.either(),e=t.other(i);this.adjList[i].push(t),this.adjList[e].push(t)},f.prototype.connected=function(t,i){for(var e=this.adjList[t],s=0;s<e.length;++s)if((r=e[s]).other(t)==i)return!0;for(var n=this.adjList[i],s=0;s<n.length;++s){var r=n[s];if(r.other(i)==t)return!0}return!1},t.Network=f}(jssim);var module=module||{};module&&(module.exports=jssim);