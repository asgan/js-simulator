var jssim=jssim||{};!function(t){t.exchange=function(t,i,e){var s=t[i];t[i]=t[e],t[e]=s},t.shuffle=function(i){for(var e=i.length,s=1;s<e;++s){var r=Math.floor(Math.random()*(1+s));t.exchange(i,s,r)}};var i=function(t){t||(t=function(t,i){return t-i}),this.s=[],this.N=0,this.compare=t};i.prototype.less=function(t,i){return this.compare(t,i)<0},i.prototype.enqueue=function(t){for(;this.s.length<=this.N+1;)this.s.push(0);this.s[++this.N]=t,this.swim(this.N)},i.prototype.delMin=function(){if(0==this.N)return null;var i=this.s[1];return t.exchange(this.s,1,this.N--),this.sink(1),i},i.prototype.min=function(){return 0==this.N?null:this.s[1]},i.prototype.sink=function(i){for(;2*i<=this.N;){var e=2*i;if(e<this.N&&this.less(this.s[e+1],this.s[e])&&e++,!this.less(this.s[e],this.s[i]))break;t.exchange(this.s,e,i),i=e}},i.prototype.swim=function(i){for(;i>1;){var e=Math.floor(i/2);if(!this.less(this.s[i],this.s[e]))break;t.exchange(this.s,i,e),i=e}},i.prototype.clear=function(){this.s=[],this.N=0},i.prototype.size=function(){return this.N},i.prototype.isEmpty=function(){return 0==this.N},t.MinPQ=i;var e=function(t){this.time=0,this.rank=t||1,this.rank<1&&(this.rank=1)},s=function(){this.pq=new t.MinPQ(function(t,i){var e=t.time-i.time;return 0==e?i.rank-t.rank:e}),this.current_time=null,this.current_rank=null};s.prototype.update=function(){for(var t=null;!this.pq.isEmpty();){var i=this.pq.min(),e=i.time;i.rank;if(null==t)t=e;else if(t!=e)break;this.update_mini()}},s.prototype.update_mini=function(){for(var i=null,e=null,s=[];!this.pq.isEmpty();){var r=this.pq.min(),n=r.time,h=r.rank;if(null==i)i=n;else if(i!=n)break;if(null==e)e=h;else if(e!=h)break;s.push(this.pq.delMin())}t.shuffle(s);for(l=0;l<s.length;++l){var o=0;o=null!=this.current_time?i-this.current_time:i,s[l].update?s[l].update(o):console.log("event does not define update(deltaTime) method!!!")}s.length>0&&(this.current_time=i,this.current_rank=e);for(var l=0;l<s.length;++l)s[l].repeatInterval&&this.scheduleRepeatingAt(s[l],this.current_time+s[l].repeatInterval,s[l].repeatInterval);return s},s.prototype.schedule=function(t,i){t.time=i,this.pq.enqueue(t)},s.prototype.hasEvents=function(){return!this.pq.isEmpty()},s.prototype.scheduleOnceIn=function(t,i){var e=this.current_time;null==this.current_time&&(e=0),t.time=e+i,this.pq.enqueue(t)},s.prototype.scheduleRepeatingIn=function(t,i){var e=this.current_time;null==this.current_time&&(e=0),this.scheduleRepeatingAt(t,e+i,i)},s.prototype.scheduleRepeatingAt=function(t,i,e){t.time=i,t.repeatInterval=e,this.pq.enqueue(t)},s.prototype.reset=function(){this.current_rank=null,this.current_time=null,this.pq.clear()},t.SimEvent=e,t.Scheduler=s;var r=function(t,i){this.x=t,this.y=i};r.prototype.distance=function(t){var i=this.x-t.x,e=this.y-t.y;return Math.sqrt(i*i+e*e)},r.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.resize=function(t){var i=this.length();if(0!=i){var e=t/i;this.x*=e,this.y*=e}},r.prototype.addIn=function(t){this.x+=t.x,this.y+=t.y},r.prototype.set=function(t,i){this.x=t,this.y=i},t.Vector2D=r;var n=function(){this.locations=[],this.agents=[],this.width=100,this.height=100};n.prototype.reset=function(){this.locations=[],this.agents=[]},n.prototype.getLocation=function(t){return this.locations[t]},n.prototype.getAgent=function(t){return this.agents[t]},n.prototype.updateAgent=function(i,e,s){this.locations[i.id]=new t.Vector2D(e,s),this.agents[i.id]=i},n.prototype.findAllAgents=function(){return this.agents},n.prototype.render=function(t){if(t){var i=t.getContext("2d");i.clearRect(0,0,t.width,t.height);for(id in this.locations){var e=this.agents[id],s=this.locations[id];i.fillStyle="#000000",e.color&&(i.fillStyle=e.color);var r=20,n=20;e.size&&(r=e.size.x,n=e.size.y),r||(r=20),n||(n=20),e.id&&(i.font="12 Arial",i.fillText(""+e.id,s.x,s.y)),i.fillRect(s.x,s.y,r,n)}}},t.Space2D=n;var h=function(t,i){this.width=t,this.height=i,this.cells=[],this.trails=[];for(var e=0;e<t;++e){this.cells.push([]),this.trails.push([]);for(var s=0;s<i;++s)this.cells[e].push(0),this.trails[e].push(0)}this.color="#ff0000",this.trailColor="#55aa55",this.cellWidth=10,this.cellHeight=10,this.showTrails=!1};h.prototype.setCell=function(t,i,e){this.cells[t][i]=e,e>0&&(this.trails[t][i]=1)},h.prototype.getCell=function(t,i){return this.cells[t][i]},h.prototype.makeCopy=function(){for(var t=new h(this.width,this.height),i=0;i<this.width;++i)for(var e=0;e<this.height;++e)0!=this.cells[i][e]&&t.setCell(i,e,1);return t},h.prototype.reset=function(){for(var t=0;t<this.width;++t)for(var i=0;i<this.height;++i)this.cells[t][i]=0,this.trails[t][i]=0},h.prototype.render=function(t){if(t){var i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.fillStyle=this.color;for(var e=0;e<this.width;++e)for(var s=0;s<this.height;++s)1==this.cells[e][s]?(i.fillStyle=this.color,i.fillRect(e*this.cellWidth,s*this.cellHeight,this.cellWidth-1,this.cellHeight-1)):this.showTrails&&1==this.trails[e][s]&&(i.fillStyle=this.trailColor,i.fillRect(e*this.cellWidth,s*this.cellHeight,this.cellWidth-1,this.cellHeight-1))}},t.Grid=h;var o=function(t,i,e){this.v=t,this.w=i,this.info=e};o.prototype.other=function(t){return t==this.v?this.w:this.v},o.prototype.either=function(){return this.v},t.Edge=o;var l=function(t){this.V=t,this.adjList=[];for(var i=0;i<t;++i)this.adjList.push([])};l.prototype.adj=function(t){return this.adjList[t]},l.prototype.reset=function(){this.adjList=[];for(var t=0;t<this.V;++t)this.adjList.push([])},l.prototype.addEdge=function(t){var i=t.either(),e=t.other(i);this.adjList[i].push(t),this.adjList[e].push(t)},l.prototype.connected=function(t,i){for(var e=this.adjList[t],s=0;s<e.length;++s)if((n=e[s]).other(t)==i)return!0;for(var r=this.adjList[i],s=0;s<r.length;++s){var n=r[s];if(n.other(i)==t)return!0}return!1},t.Network=l}(jssim);var module=module||{};module&&(module.exports=jssim);